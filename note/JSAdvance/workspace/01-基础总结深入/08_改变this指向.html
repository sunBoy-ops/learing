<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>08_改变this指向</title>
  </head>
  <body>
    <script>
      //1、apply 、 call 、bind 三者都是用来改变函数的this对象的指向的；
      //2、apply 、 call 、bind 三者第一个参数都是this要指向的对象，也就是想指定的上下文；
      //3、apply 、 call 两者都可以利用后续参数传参； 但是传参的方式不一样，apply是数组，call是正常传参形式
      var name = 'Windowname';
      // let _this = this;
      var obj = {
        name: 'objName',
        fn1: function () {
          // setTimeout(function () {
          //   console.log(this); //window
          //   this.fn2(); //报错
          // }, 100);
          // 箭头函数中的this 是初始的this的值 箭头函数没有this绑定 必须查找作用域 如果箭头函数被非箭头函数包含，则this绑定的是最近一层非箭头函数的this，否则，this的值undefined
          setTimeout(() => {
            console.log(this); //obj
            this.fn2(); //objName
          }, 100);
        },
        fn2: function () {
          // setTimeout(function () {
          //   console.log(this.name); //Windowname
          // }, 1000);
          console.log(this.name); //
        },
      };
      setTimeout(() => {
        console.log(this); //Window
      }, 1000);
      obj.fn1();
    </script>
  </body>
</html>
